<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Enigma</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

        <script src="enigma.js"></script>

        <link rel="stylesheet" href="main.css">
        <link href='https://fonts.googleapis.com/css?family=Alegreya+Sans:300' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Cutive+Mono' rel='stylesheet' type='text/css'>
    </head>

    <body>
        <h1>Enigma Simulator</h1>

        <div class="enigma-section">
            <div class="input-section">
                <input class="input-text" id="enigma-input" type="text" placeholder="Input">
            </div>

            <div class="output-section">
                <input class="output-text" id="enigma-output" type="text" placeholder="Output" readonly>
            </div>
        </div>

        <div class="configuration-section">
            <h2>Rotors settings</h2>

            <label>Initial position</label>
            <input class="rotor-config" id="rotor-left-pos" value="Q">
            <input class="rotor-config" id="rotor-middle-pos" value="I">
            <input class="rotor-config" id="rotor-right-pos" value="J">

            <br>

            <label>Ring settings</label>
            <input class="rotor-config" id="ring-left-pos" value="M">
            <input class="rotor-config" id="ring-middle-pos" value="W">
            <input class="rotor-config" id="ring-right-pos" value="B">
        </div>

        <script type="text/javascript">
        $(document).ready(function() {
            var isValidInput = function(input) {
                return /^[a-zA-Z]*$/g.test(input);
            };

            var encode = function(input) {
                var machine = new Machine();

                machine.setPlugboard(new Plugboard('MA', 'VB', 'PF'));

                var rightRotor = new RotorIII();
                rightRotor.setInnerPosition($('#ring-right-pos').val());
                rightRotor.setInitialPosition($('#rotor-right-pos').val());

                var middleRotor = new RotorII();
                middleRotor.setInnerPosition($('#ring-middle-pos').val());
                middleRotor.setInitialPosition($('#rotor-middle-pos').val());

                var leftRotor = new RotorIV();
                leftRotor.setInnerPosition($('#ring-left-pos').val());
                leftRotor.setInitialPosition($('#rotor-left-pos').val());

                machine.setRotors(leftRotor, middleRotor, rightRotor);

                machine.setReflector(new ReflectorB());

                return machine.encodeLetters(input);
            }

            $('#enigma-input').keypress(function(e) {
                if (e.keyCode == 13)
                    $('#encode-btn').click();
            });

            $('#enigma-input').keyup(function(e) {
                input = $(this).val();
                validInput = input.replace(/([^a-zA-Z]+)/gi, '').toUpperCase();
                $(this).val(validInput);
                $('#enigma-output').val(encode(validInput));
            });
        });
        </script>

        <footer>
            <p>Developed by <a href="http://www.matheusportela.com">Matheus V. Portela</a></p>
        </footer>
    </body>
</html>